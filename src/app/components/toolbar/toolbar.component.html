@let _isLargeViewport = isLargeViewport();
@let _progressBarConfiguration = progressBarConfiguration();
@let _shouldAddSafeArea = shouldAddSafeArea();
@let _toolbarTitle = toolbarTitle();
@let _user = user();

<ng-container *transloco="let t; prefix: 'jet-toolbar'">
  <mat-toolbar
    [class]="{
      'jet-add-safe-area': _shouldAddSafeArea,
      'jet-sidenav-content-toolbar': true,
    }"
  >
    <mat-progress-bar
      class="jet-progress-bar"
      [aria-label]="t('loading')"
      [bufferValue]="_progressBarConfiguration.bufferValue"
      [mode]="_progressBarConfiguration.mode"
      [style]="{ opacity: _progressBarConfiguration.isVisible ? 1 : 0 }"
      [value]="_progressBarConfiguration.value"
    />
    @if (_isLargeViewport) {
      <button
        matIconButton
        matTooltipPosition="after"
        type="button"
        [aria-label]="t('toggle-navigation-menu')"
        [jetAnalytics]="{ name: 'Toggle sidenav' }"
        [matTooltip]="t('toggle-navigation-menu')"
        (click)="toggleMatSidenav.emit()"
      >
        <mat-icon>short_text</mat-icon>
      </button>
    } @else {
      <a
        matIconButton
        matTooltipPosition="after"
        [aria-label]="t('home')"
        [jetAnalytics]="{ name: 'Open home' }"
        [matTooltip]="t('home')"
        [routerLink]="['/']"
      >
        <mat-icon svgIcon="logo" />
      </a>
    }
    <span style="font: var(--mat-sys-headline-small)">{{
      _toolbarTitle || t('loading')
    }}</span>
    <div style="flex: 1"></div>
    @if (_user !== null) {
      <a
        matIconButton
        matTooltipPosition="before"
        [aria-label]="t('sign-out')"
        [matTooltip]="t('sign-out')"
        [routerLink]="['/sign-out']"
      >
        <mat-icon>logout</mat-icon>
      </a>
    } @else {
      <a
        matIconButton
        matTooltipPosition="before"
        [aria-label]="t('sign-in')"
        [matTooltip]="t('sign-in')"
        [routerLink]="['/sign-in']"
      >
        <mat-icon>login</mat-icon>
      </a>
    }
  </mat-toolbar>
</ng-container>
